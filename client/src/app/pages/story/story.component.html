<main class="site-main outer">
  <div class="inner">
    <article class="post-full post">
      <header class="post-full-header">
        <div class="post-full-meta">
          <time class="post-full-meta-date" datetime="2017-11-07">7 November 2017</time>
          <span class="date-divider">/</span> <a href="/tag/new-things/">{{story?.story.conditionDetails.category}}</a>
        </div>
        <h1 class="post-full-title">{{story?.story.storyDetails.title}}</h1>
      </header>

      <figure class="post-full-image" [style.backgroundImage]="story && 'url(' + story?.story.storyDetails.mainImage + ')'">
        <div class="post-full-introauthors">
          <app-author-list [authors]="participants" [showDetailed]="true"></app-author-list>
        </div>
      </figure>

      <section class="post-full-content">
        <form *ngIf="allowedConditionDetails()" class="post-form">
          <div class="gh-form-group-horizontal">
            <div class="gh-form-group">
              <button (click)="isShowingCondition = !isShowingCondition" class="gh-input gh-btn-white">
                {{isShowingCondition ? 'Read Story' : 'Read Condition Details'}}
              </button>
            </div>

            <div *ngIf="allowedSubmitResearch()" class="gh-form-group">
              <button class="gh-input gh-btn-white">Submit Research</button>
            </div>
          </div>
        </form>

        <div *ngIf="!isShowingCondition" class="kg-card-markdown">
          <p>{{story?.story.storyDetails.details}}</p>
        </div>

        <div *ngIf="isShowingCondition">
          <app-condition [details]="story?.story.conditionDetails"></app-condition>
        </div>
      </section>
    </article>
  </div>
</main>

<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">
      <app-post-card class="read-next-card" [details]="fundingCardDetails">
        <form [formGroup]="fundingForm" class="post-form">
          <div class="gh-form-group gh-form-group-horizontal">
            <div class="input-group">
              <input type="number" formControlName="diagAmount" class="gh-input" placeholder="100.00">
              <div class="input-group-append">
                <span class="input-group-text">DIAG</span>
              </div>
            </div>

            <img class="spacer-icon" src="/assets/convert-icon.svg" alt="≈">

            <div class="input-group">
              <input type="number" formControlName="currencyAmount" class="gh-input" placeholder="10.00">
              <div class="input-group-append">
                <span class="input-group-text">USD</span>
              </div>
            </div>
          </div>

          <div class="gh-form-group">
            <input type="submit" value="Contribute" (click)="onSubmitContribution()" class="gh-input gh-btn-blue">
          </div>
        </form>
      </app-post-card>

      <app-post-card *ngIf="!allowedAssignRoles()" class="read-next-card post-card-secondary" [details]="researchCardDetails">
        <form class="post-form">
          <div class="gh-form-group">
            <input type="button" value="Start Researching" (click)="onRequestToResearch()" class="gh-input gh-btn-white">
          </div>
        </form>
      </app-post-card>

      <app-post-card *ngIf="allowedAssignRoles()" class="read-next-card post-card-secondary" [details]="rolesCardDetails">
        <form [formGroup]="researcherForm" class="post-form">
          <div class="gh-form-group-horizontal">
            <div class="gh-form-group">
              <label for="worker">Researcher</label>
              <input type="text" formControlName="worker" id="worker" class="gh-input" placeholder="e.g. 0x90F8bf…">
            </div>

            <div class="gh-form-group">
              <label for="evaluator">Evaluator</label>
              <input type="text" formControlName="evaluator" id="evaluator" class="gh-input" placeholder="e.g. 0x6A479f…">
            </div>
          </div>

          <div class="gh-form-group">
            <input type="submit" value="Assign Roles" (click)="onAssignRoles()" class="gh-input gh-btn-white">
          </div>
        </form>
      </app-post-card>
    </div>
  </div>
</aside>
